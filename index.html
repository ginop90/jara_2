<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Jara DJ's, sonido e iluminaci√≥n</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Arial', sans-serif;
        }

        body {
            background-color: #121212;
            color: white;
            min-height: 100vh;
        }

        .container {
            max-width: 800px;
            margin: 0 auto;
            padding: 20px;
        }

        header {
            display: flex;
            flex-direction: column;
            align-items: center;
            margin-bottom: 30px;
            padding: 20px 0;
            border-bottom: 1px solid #333;
        }

        .logo {
            width: 150px;
            height: 150px;
            background-color: #333;
            border-radius: 50%;
            display: flex;
            justify-content: center;
            align-items: center;
            margin-bottom: 15px;
            font-size: 24px;
        }

        h1 {
            margin: 10px 0;
            text-align: center;
            font-size: 28px;
            color: #f5f5f5;
        }

        nav {
            display: flex;
            justify-content: center;
            gap: 20px;
            margin-top: 20px;
        }

        .main-options {
            display: flex;
            flex-direction: column;
            gap: 20px;
            margin-top: 30px;
        }

        .option-btn {
            background-color: #252525;
            color: white;
            border: none;
            padding: 20px;
            border-radius: 10px;
            font-size: 18px;
            cursor: pointer;
            transition: background-color 0.3s, transform 0.2s;
            display: flex;
            justify-content: center;
            align-items: center;
            gap: 10px;
        }

        .option-btn:hover {
            background-color: #333;
            transform: translateY(-3px);
        }

        .emoji {
            font-size: 24px;
        }

        .back-btn {
            background-color: transparent;
            color: #999;
            border: none;
            padding: 10px;
            margin-bottom: 20px;
            cursor: pointer;
            display: flex;
            align-items: center;
            gap: 5px;
        }

        .back-btn:hover {
            color: white;
        }

        .form-section {
            background-color: #1e1e1e;
            padding: 20px;
            border-radius: 10px;
            margin-bottom: 20px;
            margin-top: 30px;
        }

        .form-group {
            margin-bottom: 15px;
        }

        label {
            display: block;
            margin-bottom: 5px;
            color: #ccc;
        }

        input, select, textarea {
            width: 100%;
            padding: 10px;
            background-color: #333;
            border: 1px solid #444;
            border-radius: 5px;
            color: white;
            font-size: 16px;
        }

        textarea {
            resize: vertical;
            white-space: pre-wrap;
        }

        .amount-input {
            position: relative;
        }

        .amount-input input {
            padding-left: 25px;
        }

        .amount-input::before {
            content: "$";
            position: absolute;
            left: 10px;
            top: 50%;
            transform: translateY(-50%);
            color: #ccc;
        }

        .total-section {
            background-color: #252525;
            padding: 15px;
            border-radius: 5px;
            margin-top: 20px;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .total-label {
            font-size: 18px;
            font-weight: bold;
        }

        .total-amount {
            font-size: 20px;
            font-weight: bold;
            color: #4caf50;
        }

        .action-btn {
            background-color: #4caf50;
            color: white;
            border: none;
            padding: 15px 25px;
            border-radius: 5px;
            font-size: 16px;
            cursor: pointer;
            display: block;
            margin: 30px auto 0;
            transition: background-color 0.3s;
        }

        .action-btn:hover {
            background-color: #3e8e41;
        }

        .hidden {
            display: none;
        }

        .extras-container {
            margin-top: 20px;
        }

        .extra-item {
            display: flex;
            gap: 10px;
            margin-bottom: 10px;
            align-items: flex-start;
        }

        .extra-item .form-group {
            flex: 1;
            margin-bottom: 0;
        }

        .extra-controls {
            display: flex;
            gap: 10px;
            margin-top: 26px;
        }

        .btn-add-extra, .btn-remove-extra {
            border: none;
            width: 30px;
            height: 30px;
            border-radius: 50%;
            display: flex;
            justify-content: center;
            align-items: center;
            cursor: pointer;
            font-weight: bold;
            flex-shrink: 0;
        }

        .btn-add-extra {
            background-color: #4caf50;
            color: white;
        }

        .btn-remove-extra {
            background-color: #f44336;
            color: white;
        }

        @media (min-width: 768px) {
            .main-options {
                flex-direction: row;
            }
            
            .option-btn {
                flex: 1;
            }
        }

        .pdf-content {
            background-color: black;
            color: white;
            padding: 20px;
            display: none;
        }

        .pdf-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 15px;
            margin-bottom: 20px;
            background-color: #222;
            color: white;
        }

        .pdf-header-left {
            display: flex;
            flex-direction: column;
            text-align: left;
        }

        .pdf-header-right {
            display: flex;
            justify-content: center;
            align-items: center;
        }

        .pdf-logo {
            width: 80px;
            height: 80px;
            background-color: #333;
            border-radius: 50%;
            display: flex;
            justify-content: center;
            align-items: center;
            font-size: 16px;
            color: white;
        }

        .pdf-company-name {
            font-size: 22px;
            font-weight: bold;
            margin-bottom: 5px;
        }

        .pdf-company-subtitle {
            font-size: 16px;
            color: #ccc;
        }

        .pdf-row {
            display: flex;
            margin-bottom: 10px;
            align-items: baseline; /* Align items at the baseline */
        }

        .pdf-row-label {
            flex: 0 0 100px; /* Fixed width for labels */
            margin-right: 10px; /* Space between label and value */
            text-align: left;
            font-weight: bold;
        }

        .pdf-row-value {
            flex: 1;
            text-align: left; /* Left-align the values */
            word-break: break-word;
        }

        .pdf-document-type {
            font-size: 18px;
            font-weight: bold;
            margin-bottom: 10px;
            text-align: center;
            width: 100%;
        }

        .pdf-row .pdf-document-type + .pdf-row-value {
            margin-left: auto; /* Push the date to the right of the document type */
        }

        .pdf-detail {
            margin-bottom: 15px;
            white-space: pre-wrap;
        }

        .pdf-total {
            text-align: right;
            font-weight: bold;
            margin-top: 20px;
            font-size: 18px;
        }

        .pdf-extra-row {
            display: flex;
            justify-content: space-between;
            margin-bottom: 5px;
        }
    </style>
</head>
<body>
    <div class="container">
        <!-- P√°gina principal -->
        <div id="home-page">
            <header>
                <div class="logo">
                    üéß üéµ üí°
                </div>
                <h1>Jara DJ's, sonido e iluminaci√≥n</h1>
            </header>
            
            <div class="main-options">
                <button class="option-btn" onclick="showPage('presupuesto-page')">
                    <span class="emoji">üìù</span> Presupuestos
                </button>
                <button class="option-btn" onclick="showPage('recibo-page')">
                    <span class="emoji">üßæ</span> Recibos
                </button>
            </div>
        </div>

        <!-- P√°gina de Presupuestos -->
        <div id="presupuesto-page" class="hidden">
            <button class="back-btn" onclick="showPage('home-page')">
                ‚Üê Volver
            </button>
            
            <h1>Generar Presupuesto <span class="emoji">üìù</span></h1>
            
            <div class="form-section">
                <div class="form-group">
                    <label for="presupuesto-fecha">Fecha:</label>
                    <input type="date" id="presupuesto-fecha" name="fecha">
                </div>
                
                <div class="form-group">
                    <label for="presupuesto-salon">Sal√≥n:</label>
                    <input type="text" id="presupuesto-salon" name="salon" placeholder="Nombre del sal√≥n">
                </div>
                
                <div class="form-group">
                    <label for="presupuesto-evento">Tipo de Evento:</label>
                    <input type="text" id="presupuesto-evento" name="evento" placeholder="Ej: Casamiento, Fiesta de 15, etc.">
                </div>

                <div class="form-group">
                    <label for="presupuesto-fecha-evento">Fecha Evento:</label>
                    <input type="date" id="presupuesto-fecha-evento" name="fecha-evento">
                </div>
                
                <div class="form-group">
                    <label for="presupuesto-cliente">Cliente:</label>
                    <input type="text" id="presupuesto-cliente" name="cliente" placeholder="Nombre del cliente">
                </div>
            </div>
            
            <div class="form-section">
                <div class="form-group">
                    <label for="presupuesto-detalles">Detalles:</label>
                    <textarea id="presupuesto-detalles" name="detalles" rows="4" placeholder="Descripci√≥n de equipos y servicios..."></textarea>
                </div>
                
                <div class="form-group">
                    <label for="presupuesto-importe">Importe:</label>
                    <div class="amount-input">
                        <input type="number" id="presupuesto-importe" name="importe" placeholder="0" min="0" oninput="calcularTotalPresupuesto()">
                    </div>
                </div>
            </div>
            
            <div class="form-section">
                <h3>Extras</h3>
                <div id="extras-container">
                    <!-- Los extras se agregar√°n aqu√≠ din√°micamente -->
                </div>
                
                <button type="button" class="btn-add-extra" onclick="agregarExtra()">+</button>
            </div>
            
            <div class="total-section">
                <span class="total-label">TOTAL:</span>
                <span class="total-amount" id="presupuesto-total">$0</span>
            </div>
            
            <button class="action-btn" onclick="generarPDFPresupuesto()">
                Generar PDF <span class="emoji">üìÑ</span>
            </button>
        </div>

        <!-- P√°gina de Recibos -->
        <div id="recibo-page" class="hidden">
            <button class="back-btn" onclick="showPage('home-page')">
                ‚Üê Volver
            </button>
            
            <h1>Generar Recibo <span class="emoji">üßæ</span></h1>
            
            <div class="form-section">
                <div class="form-group">
                    <label for="recibo-fecha">Fecha:</label>
                    <input type="date" id="recibo-fecha" name="fecha">
                </div>
                
                <div class="form-group">
                    <label for="recibo-salon">Sal√≥n:</label>
                    <input type="text" id="recibo-salon" name="salon" placeholder="Nombre del sal√≥n">
                </div>
                
                <div class="form-group">
                    <label for="recibo-evento">Tipo de Evento:</label>
                    <input type="text" id="recibo-evento" name="evento" placeholder="Ej: Casamiento, Fiesta de 15, etc.">
                </div>
                
                <div class="form-group">
                    <label for="recibo-cliente">Cliente:</label>
                    <input type="text" id="recibo-cliente" name="cliente" placeholder="Nombre del cliente">
                </div>
            </div>
            
            <div class="form-section">
                <div class="form-group">
                    <label for="recibo-detalle">Detalle:</label>
                    <textarea id="recibo-detalle" name="detalle" rows="2" placeholder="Descripci√≥n del servicio..."></textarea>
                </div>
                
                <div class="form-group">
                    <label for="recibo-importe">Importe Recibido:</label>
                    <div class="amount-input">
                        <input type="number" id="recibo-importe" name="importe" placeholder="0" min="0">
                    </div>
                </div>
            </div>
            
            <button class="action-btn" onclick="generarPDFRecibo()">
                Generar PDF <span class="emoji">üìÑ</span>
            </button>
        </div>
        
        <!-- Contenido para PDF Presupuesto -->
        <div id="pdf-presupuesto" class="pdf-content">
            <div class="pdf-header">
                <div class="pdf-header-left">
                    <div class="pdf-company-name">Jara DJ Group</div>
                    <div class="pdf-company-subtitle">DJ, Sonido e Iluminaci√≥n</div>
                </div>
                <div class="pdf-header-right">
                    <div class="pdf-logo">Logo</div>
                </div>
            </div>
            <div class="pdf-body">
                <div class="pdf-row">
                    <div class="pdf-document-type">PRESUPUESTO</div>
                </div>
                <div class="pdf-row">
                    <div class="pdf-row-label">Fecha:</div>
                    <div class="pdf-row-value" id="pdf-presupuesto-fecha"></div>
                </div>
                <div class="pdf-row">
                    <div class="pdf-row-label">Sal√≥n:</div>
                    <div class="pdf-row-value" id="pdf-presupuesto-salon"></div>
                </div>
                <div class="pdf-row">
                    <div class="pdf-row-label">Evento:</div>
                    <div class="pdf-row-value" id="pdf-presupuesto-evento"></div>
                </div>
                <div class="pdf-row">
                    <div class="pdf-row-label">Fecha Evento:</div>
                    <div class="pdf-row-value" id="pdf-presupuesto-fecha-evento"></div>
                </div>
                <div class="pdf-row">
                    <div class="pdf-row-label">Cliente:</div>
                    <div class="pdf-row-value" id="pdf-presupuesto-cliente"></div>
                </div>
                <hr>
                <div class="pdf-row">
                    <div class="pdf-row-hr"></div>
                </div>
                <div class="pdf-row">
                    <div class="pdf-row-label">Detalles:</div>
                </div>
                <div class="pdf-detail" id="pdf-presupuesto-detalles"></div>
                <div class="pdf-row">
                    <div style="width: 70%; text-align: left;">Importe:</div>
                    <div style="width: 30%; text-align: right;"><span id="pdf-presupuesto-importe"></span></div>
                </div>
                <div id="pdf-extras-container">
                    <!-- Los extras se agregar√°n aqu√≠ din√°micamente -->
                </div>
                <div class="pdf-total">
                    TOTAL: <span id="pdf-presupuesto-total"></span>
                </div>
            </div>
        </div>
        
        <!-- Contenido para PDF Recibo -->
        <div id="pdf-recibo" class="pdf-content">
            <div class="pdf-header">
                <div class="pdf-header-left">
                    <div class="pdf-company-name">Jara DJ Group</div>
                    <div class="pdf-company-subtitle">DJ, Sonido e Iluminaci√≥n</div>
                </div>
                <div class="pdf-header-right">
                    <div class="pdf-logo">Logo</div>
                </div>
            </div>
            <div class="pdf-body">
                <div class="pdf-row">
                    <div class="pdf-document-type">RECIBO</div>
                </div>
                <div class="pdf-row">
                    <div class="pdf-row-label">Fecha:</div>
                    <div class="pdf-row-value" id="pdf-recibo-fecha"></div>
                </div>
                <div class="pdf-row">
                    <div class="pdf-row-label">Sal√≥n:</div>
                    <div class="pdf-row-value" id="pdf-recibo-salon"></div>
                </div>
                <div class="pdf-row">
                    <div class="pdf-row-label">Evento:</div>
                    <div class="pdf-row-value" id="pdf-recibo-evento"></div>
                </div>
                <div class="pdf-row">
                    <div class="pdf-row-label">Cliente:</div>
                    <div class="pdf-row-value" id="pdf-recibo-cliente"></div>
                </div>
                <hr>
                <div class="pdf-row">
                    <div class="pdf-row-hr"></div>
                </div>
                <div class="pdf-row">
                    <div class="pdf-row-label">Detalle:</div>
                </div>
                <div class="pdf-detail" id="pdf-recibo-detalle"></div>
                <div class="pdf-total">
                    TOTAL RECIBIDO: <span id="pdf-recibo-importe"></span>
                </div>
            </div>
        </div>
    </div>

    <script>
        // [Previous script remains exactly the same]
        // Variables para manejar extras
        let extrasCount = 0;
        const extras = [];
        
        // Funciones para cambiar de p√°gina
        function showPage(pageId) {
            document.getElementById('home-page').classList.add('hidden');
            document.getElementById('presupuesto-page').classList.add('hidden');
            document.getElementById('recibo-page').classList.add('hidden');
            
            document.getElementById(pageId).classList.remove('hidden');
        }
        
        // Establecer la fecha actual en los campos fecha
        function setFechaActual() {
            const today = new Date();
            const formattedDate = today.toISOString().split('T')[0];
            
            document.getElementById('presupuesto-fecha').value = formattedDate;
            document.getElementById('recibo-fecha').value = formattedDate;
        }
        
        // Agregar un extra
        function agregarExtra() {
            extrasCount++;
            const extraId = `extra-${extrasCount}`;
            
            const extraDiv = document.createElement('div');
            extraDiv.className = 'extra-item';
            extraDiv.id = extraId;
            extraDiv.innerHTML = `
                <div class="form-group">
                    <label for="${extraId}-desc">Descripci√≥n:</label>
                    <input type="text" id="${extraId}-desc" placeholder="Descripci√≥n del extra" class="extra-descripcion">
                </div>
                <div class="form-group">
                    <label for="${extraId}-importe">Importe:</label>
                    <div class="amount-input">
                        <input type="number" id="${extraId}-importe" placeholder="0" min="0" class="extra-importe" oninput="calcularTotalPresupuesto()">
                    </div>
                </div>
                <div class="extra-controls">
                    <button type="button" class="btn-remove-extra" onclick="eliminarExtra('${extraId}')">√ó</button>
                </div>
            `;
            
            document.getElementById('extras-container').appendChild(extraDiv);
            extras.push(extraId);
        }
        
        // Eliminar un extra
        function eliminarExtra(extraId) {
            const extraElement = document.getElementById(extraId);
            if (extraElement) {
                extraElement.remove();
                
                // Eliminar del array
                const index = extras.indexOf(extraId);
                if (index > -1) {
                    extras.splice(index, 1);
                }
                
                calcularTotalPresupuesto();
            }
        }
        
        // Calcular el total del presupuesto
        function calcularTotalPresupuesto() {
            const importe = parseFloat(document.getElementById('presupuesto-importe').value) || 0;
            
            // Sumar todos los extras
            let totalExtras = 0;
            extras.forEach(extraId => {
                const extraImporte = document.getElementById(`${extraId}-importe`);
                if (extraImporte) {
                    totalExtras += parseFloat(extraImporte.value) || 0;
                }
            });
            
            const total = importe + totalExtras;
            
            document.getElementById('presupuesto-total').textContent = `$${total.toLocaleString()}`;
        }
        
        // Formatear un n√∫mero como moneda
        function formatCurrency(value) {
            const number = parseFloat(value) || 0;
            return `$${number.toLocaleString()}`;
        }
        
        // Generar PDF de Presupuesto
        function generarPDFPresupuesto() {
            // Obtener los valores del formulario
            const fecha = document.getElementById('presupuesto-fecha').value;
            const fechaEvento = document.getElementById('presupuesto-fecha-evento').value;
            const salon = document.getElementById('presupuesto-salon').value;
            const evento = document.getElementById('presupuesto-evento').value;
            const cliente = document.getElementById('presupuesto-cliente').value;
            const detalles = document.getElementById('presupuesto-detalles').value;
            const importe = document.getElementById('presupuesto-importe').value;
            
            // Actualizar contenido del PDF
            document.getElementById('pdf-presupuesto-fecha').textContent = formatDate(fecha);
            document.getElementById('pdf-presupuesto-fecha-evento').textContent = formatDate(fechaEvento);
            document.getElementById('pdf-presupuesto-salon').textContent = salon;
            document.getElementById('pdf-presupuesto-evento').textContent = evento;
            document.getElementById('pdf-presupuesto-cliente').textContent = cliente;
            document.getElementById('pdf-presupuesto-detalles').textContent = detalles;
            document.getElementById('pdf-presupuesto-importe').textContent = formatCurrency(importe);
            
            // Limpiar el contenedor de extras
            const pdfExtrasContainer = document.getElementById('pdf-extras-container');
            pdfExtrasContainer.innerHTML = '';
            
            // Agregar los extras al PDF
            let totalExtras = 0;
            extras.forEach(extraId => {
                const extraDesc = document.getElementById(`${extraId}-desc`).value;
                const extraImporte = parseFloat(document.getElementById(`${extraId}-importe`).value) || 0;
                
                if (extraDesc || extraImporte > 0) {
                    const extraDiv = document.createElement('div');
                    extraDiv.className = 'pdf-extra-row';
                    extraDiv.innerHTML = `
                        <div class="pdf-extra-name">${extraDesc}</div>
                        <div class="pdf-extra-amount">${formatCurrency(extraImporte)}</div>
                    `;
                    pdfExtrasContainer.appendChild(extraDiv);
                    
                    totalExtras += extraImporte;
                }
            });
            
            const total = (parseFloat(importe) || 0) + totalExtras;
            document.getElementById('pdf-presupuesto-total').textContent = formatCurrency(total);
            
            // Generar PDF
            generatePDF('pdf-presupuesto', `Presupuesto_${cliente}_${formatDateFile(fecha)}`);
        }
        
        // Generar PDF de Recibo
        function generarPDFRecibo() {
            // Obtener los valores del formulario
            const fecha = document.getElementById('recibo-fecha').value;
            const salon = document.getElementById('recibo-salon').value;
            const evento = document.getElementById('recibo-evento').value;
            const cliente = document.getElementById('recibo-cliente').value;
            const detalle = document.getElementById('recibo-detalle').value;
            const importe = document.getElementById('recibo-importe').value;
            
            // Actualizar contenido del PDF
            document.getElementById('pdf-recibo-fecha').textContent = formatDate(fecha);
            document.getElementById('pdf-recibo-salon').textContent = salon;
            document.getElementById('pdf-recibo-evento').textContent = evento;
            document.getElementById('pdf-recibo-cliente').textContent = cliente;
            document.getElementById('pdf-recibo-detalle').textContent = detalle;
            document.getElementById('pdf-recibo-importe').textContent = formatCurrency(importe);
            
            // Generar PDF
            generatePDF('pdf-recibo', `Recibo_${cliente}_${formatDateFile(fecha)}`);
        }
        
        // Funci√≥n para generar PDF usando html2canvas y jsPDF
        function generatePDF(elementId, filename) {
            const { jsPDF } = window.jspdf;
            
            // Mostrar temporalmente el elemento para capturarlo
            const element = document.getElementById(elementId);
            element.style.display = 'block';
            
            // Crear PDF
            html2canvas(element, { 
                scale: 2,
                backgroundColor: '#000000'
            }).then(canvas => {
                const imgData = canvas.toDataURL('image/png');
                const pdf = new jsPDF('p', 'mm', 'a4');
                const imgWidth = 210;
                const pageHeight = 297;
                const imgHeight = canvas.height * imgWidth / canvas.width;
                let heightLeft = imgHeight;
                let position = 0;
                
                pdf.addImage(imgData, 'PNG', 0, position, imgWidth, imgHeight);
                heightLeft -= pageHeight;
                
                while (heightLeft >= 0) {
                    position = heightLeft - imgHeight;
                    pdf.addPage();
                    pdf.addImage(imgData, 'PNG', 0, position, imgWidth, imgHeight);
                    heightLeft -= pageHeight;
                }
                
                pdf.save(`${filename}.pdf`);
                
                // Ocultar el elemento despu√©s de la captura
                element.style.display = 'none';
                
                // Si es m√≥vil, intentar compartir el archivo
                if (isMobile()) {
                    const blob = pdf.output('blob');
                    const file = new File([blob], `${filename}.pdf`, { type: 'application/pdf' });
                    
                    if (navigator.share) {
                        navigator.share({
                            files: [file],
                            title: filename,
                        }).catch((error) => {
                            console.error('Error compartiendo archivo:', error);
                        });
                    }
                }
            });
        }
        
        // Detectar si es dispositivo m√≥vil
        function isMobile() {
            return /Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent);
        }
        
        // Formatear fecha
        function formatDate(dateString) {
            if (!dateString) return '';
            
            const date = new Date(dateString);
            return date.toLocaleDateString('es-AR');
        }
        
        // Formatear fecha para nombre de archivo
        function formatDateFile(dateString) {
            if (!dateString) return '';
            
            const date = new Date(dateString);
            return `${date.getDate()}-${date.getMonth() + 1}-${date.getFullYear()}`;
        }
        
        // Inicializar al cargar la p√°gina
        window.onload = function() {
            setFechaActual();
            // Agregar un extra por defecto
            agregarExtra();
        };
    </script>
</body>
</html>
